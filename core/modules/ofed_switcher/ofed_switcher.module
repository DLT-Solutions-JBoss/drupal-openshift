<?php

/**
 *  Implements hook_toolbar_alter().
 */
function ofed_switcher_toolbar_alter(&$items) {
  $items['administration']['#attached']['library'][] = 'ofed_switcher/ofed_switcher';

  if (!empty($items['administration']['tray']['toolbar_administration']['#pre_render'])) {
    $items['administration']['tray']['toolbar_administration']['#pre_render'][] = 'ofed_switcher_prerender_toolbar_administration_tray';
  }

}

/**
 * Callback for ofed_switcher_toolbar_alter().
 */
function ofed_switcher_prerender_toolbar_administration_tray (array $element) {
  // Remove Help item (too technical for content editors).
  unset($element['administration_menu']['#items']['help.main']);
  // Remove drupal.org item (irrelevant to content editors).
  unset($element['administration_menu']['#items']['admin_toolbar_tools.help']['below']['admin_toolbar_tools.drupalorg']);
  // Remove "Index" item (too technical for content editors).
  unset($element['administration_menu']['#items']['admin_toolbar_tools.help']['below']['system.admin_index']);

  return $element;
}
